# ๐จ ุฅุตูุงุญ ุนุงุฌู: ุงูุจูููุงุฑู ูููุณุชุฎุฏููู ุงูุนุงุฏููู

## ๐ ุงููุดููุฉ ุงูููุชุดูุฉ

### ุงูุฃุนุฑุงุถ
- โ ุงูุจูููุงุฑู ุชุนูู ููุฃุฏูู
- โ ุงูุจูููุงุฑู **ูุง ุชุนูู** ูููุณุชุฎุฏููู ุงูุนุงุฏููู
- โ ุงูุตูุญุฉ ุชุจูู ูู ุญุงูุฉ ุชุญููู ูุณุชูุฑ ูููุณุชุฎุฏููู ุงูุนุงุฏููู

### ุฑุณุงูุฉ ุงูุฎุทุฃ
ูู Developer Console:
```
Please include valid named relation "mangas" in your query's embedded resource params
```

### ุงูุณุจุจ ุงูุฌุฐุฑู
ุงููุดููุฉ ูู **RLS Policy** ูุฌุฏูู `mangas`:

```sql
-- โ Policy ุงููุฏููุฉ (ุฎุงุทุฆุฉ)
CREATE POLICY "mangas_select_policy" ON mangas
    FOR SELECT
    USING (true);  -- ุชุจุฏู ุตุญูุญุฉุ ููู ูุง ุชุนูู ูุน joins
```

**ููุงุฐุง ูุง ุชุนููุ**
- ุนูุฏ ุฌูุจ ุงูุจูููุงุฑูุ ูุณุชุฎุฏู ุงุณุชุนูุงู ูุน `JOIN`:
  ```sql
  SELECT * FROM bookmarks b
  JOIN mangas m ON b.manga_id = m.id
  ```
- Policy ุงููุฏููุฉ ูุง ุชุณูุญ ุจูุฑุงุกุฉ `mangas` ุนุจุฑ `JOIN` ูููุณุชุฎุฏููู ุบูุฑ ุงููุตุงุฏู ุนูููู
- ุงูุฃุฏูู ูุนูููู ูุฃู ูุฏููู ุตูุงุญูุงุช ุฎุงุตุฉ

---

## โ ุงูุญู

### ุงูุฎุทูุฉ 1: ููุฐ ุงูุฅุตูุงุญ ุงูุนุงุฌู

1. **ุงูุชุญ Supabase SQL Editor**
2. **ุงูุชุญ ุงูููู**: `FIX_BOOKMARKS_FOR_USERS.sql`
3. **ุงูุณุฎ ูู ูุญุชููุงุชู**
4. **ุงูุตููุง ูู SQL Editor**
5. **ุงุถุบุท Run**

### ุงูุฎุทูุฉ 2: ุงุฎุชุจุฑ ุงููุชูุฌุฉ

1. **ุงูุชุญ ุงููููุน ูู ูุงูุฐุฉ ุชุตูุญ ุฎูู** (Incognito/Private)
2. **ุณุฌู ุงูุฏุฎูู ููุณุชุฎุฏู ุนุงุฏู** (ููุณ ุฃุฏูู)
3. **ุงุฐูุจ ุฅูู `/bookmarks`**
4. **ูุฌุจ ุฃู ุชุธูุฑ ุงูุตูุญุฉ ููุฑุงู!** โ

---

## ๐ง ุงูุชูุงุตูู ุงูุชูููุฉ

### ูุง ุชู ุชุบููุฑู

#### ูุจู (โ ูุง ูุนูู):
```sql
CREATE POLICY "mangas_select_policy" ON mangas
    FOR SELECT
    USING (true);
```

#### ุจุนุฏ (โ ูุนูู):
```sql
CREATE POLICY "mangas_public_read" ON mangas
    FOR SELECT
    TO public  -- ๐ ูุฐุง ูู ุงูููุชุงุญ!
    USING (true);
```

### ุงููุฑู ุงูุฑุฆูุณู

- **`TO public`**: ูุณูุญ ูุฃู ุดุฎุต (ูุณุฌู ุฃู ุบูุฑ ูุณุฌู) ุจูุฑุงุกุฉ ุงูุจูุงูุงุช
- ุจุฏูู `TO public`: ูุชู ุชุทุจูู Policy ููุท ุนูู ุงููุณุชุฎุฏููู ุงููุตุงุฏู ุนูููู
- ูุน `TO public`: ูุชู ุชุทุจูู Policy ุนูู ุงูุฌููุนุ ุจูุง ูู ุฐูู ุนูุฏ ุงุณุชุฎุฏุงู `JOIN`

---

## ๐ ููู ูุนูู ุงูุขู

### ุงุณุชุนูุงู ุงูุจูููุงุฑู ูู ุงูููุฏ

```typescript
// ูู app/bookmarks/page.tsx
const { data, error } = await supabase
    .from('bookmarks')
    .select(`
        manga_id,
        mangas (
            id, title, cover_image, status, rating, slug
        )
    `)
    .eq('user_id', user.id);
```

### ูุง ูุญุฏุซ ุฎูู ุงูููุงููุณ

1. **Supabase ูุชุฑุฌู ุงูุงุณุชุนูุงู ุฅูู**:
   ```sql
   SELECT 
       b.manga_id,
       m.id, m.title, m.cover_image, m.status, m.rating, m.slug
   FROM bookmarks b
   JOIN mangas m ON b.manga_id = m.id
   WHERE b.user_id = 'user-id';
   ```

2. **RLS Policies ูุชู ุงูุชุญูู ูููุง**:
   - โ `bookmarks`: ุงููุณุชุฎุฏู ููููู ุฑุคูุฉ ุจูููุงุฑูู ููุท
   - โ `mangas`: ุงูุขู **ุงูุฌููุน** ูููููู ูุฑุงุกุฉ ุจูุงูุงุช ุงููุงูุฌุง

3. **ุงููุชูุฌุฉ**: ุงูุจูููุงุฑู ุชุนูู ููุฌููุน! ๐

---

## ๐งช ุงุฎุชุจุงุฑ ุดุงูู

### ุงุฎุชุจุงุฑ 1: ูุณุชุฎุฏู ุนุงุฏู
```
1. ุงูุชุญ ูุงูุฐุฉ ุชุตูุญ ุฎูู
2. ุณุฌู ุงูุฏุฎูู ููุณุชุฎุฏู ุนุงุฏู
3. ุงุฐูุจ ุฅูู /bookmarks
4. ุงููุชูุฌุฉ ุงููุชููุนุฉ: โ ุงูุตูุญุฉ ุชุธูุฑ ููุฑุงู
```

### ุงุฎุชุจุงุฑ 2: ุฃุฏูู
```
1. ุณุฌู ุงูุฏุฎูู ูุฃุฏูู
2. ุงุฐูุจ ุฅูู /bookmarks
3. ุงููุชูุฌุฉ ุงููุชููุนุฉ: โ ุงูุตูุญุฉ ุชุนูู (ููุง ูุงูุช)
```

### ุงุฎุชุจุงุฑ 3: ุบูุฑ ูุณุฌู
```
1. ุงูุชุญ ูุงูุฐุฉ ุชุตูุญ ุฎูู
2. ูุง ุชุณุฌู ุงูุฏุฎูู
3. ุญุงูู ุงูุฏุฎูู ุฅูู /bookmarks
4. ุงููุชูุฌุฉ ุงููุชููุนุฉ: โ ูุชู ุชูุฌููู ุฅูู /login
```

---

## โ ุฃุณุฆูุฉ ุดุงุฆุนุฉ

### ุณ1: ูู ูุฐุง ุขููุ

**ุฌ:** ูุนูุ ุชูุงูุงู!
- ูุฑุงุกุฉ ุจูุงูุงุช ุงููุงูุฌุง **ุนุงูุฉ** (ุงูุฌููุน ูุฌุจ ุฃู ูุฑุงูุง)
- ุงูุจูููุงุฑู **ุฎุงุตุฉ** (ูู ูุณุชุฎุฏู ูุฑู ุจูููุงุฑูู ููุท)
- ุงูุฅุถุงูุฉ/ุงูุชุนุฏูู/ุงูุญุฐู **ูุญููุฉ** (ููุท ูููุตุฑุญ ููู)

### ุณ2: ููุงุฐุง ูู ุชุธูุฑ ุงููุดููุฉ ููุฃุฏููุ

**ุฌ:** ูุฃู Supabase ูุนุทู ุงูุฃุฏูู ุตูุงุญูุงุช ุฎุงุตุฉ:
- ุงูุฃุฏูู ูุฏููู `service_role` ุถูููุงู
- ูููููู ุชุฌุงูุฒ ุจุนุถ RLS Policies
- ูุฐูู ูู ุชุธูุฑ ุงููุดููุฉ ุฅูุง ูููุณุชุฎุฏููู ุงูุนุงุฏููู

### ุณ3: ูู ูุคุซุฑ ูุฐุง ุนูู ุงูุฃูุงูุ

**ุฌ:** ูุงุ ุจู ูุญุณูู!
- ุงูุขู Policies ูุงุถุญุฉ ููุญุฏุฏุฉ
- ูู ุฌุฏูู ูู Policy ุตุญูุญุฉ
- ุงูุฃูุงู ุฃูุถู ูู ูุจู

---

## ๐ฏ ุงูุฎูุงุตุฉ

### ูุจู ุงูุฅุตูุงุญ
- โ ุงูุจูููุงุฑู ูุง ุชุนูู ูููุณุชุฎุฏููู ุงูุนุงุฏููู
- โ ุงูุจูููุงุฑู ุชุนูู ููุฃุฏูู ููุท

### ุจุนุฏ ุงูุฅุตูุงุญ
- โ ุงูุจูููุงุฑู ุชุนูู ููุฌููุน
- โ ุงูุฃูุงู ูุญููุธ
- โ ุงูุฃุฏุงุก ูุญุณูู

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. โ **ููุฐ** `FIX_BOOKMARKS_FOR_USERS.sql`
2. โ **ุงุฎุชุจุฑ** ูุน ูุณุชุฎุฏู ุนุงุฏู
3. โ **ุชุฃูุฏ** ูู ุนูู ุงูุจูููุงุฑู
4. โ **ุฃุฎุจุฑ ุงูุฃุฏูู** ุฃู ุงููุดููุฉ ุญููุช

---

**ุชู ุฅูุดุงุก ูุฐุง ุงูุฅุตูุงุญ ูู**: ุฏูุณูุจุฑ 2025  
**ุงูุญุงูุฉ**: โ ุฌุงูุฒ ููุชูููุฐ  
**ุงูููุช ุงููุชููุน**: 30 ุซุงููุฉ ููุท!
