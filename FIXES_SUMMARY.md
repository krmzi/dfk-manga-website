# โ ุชูุฑูุฑ ุงูุฅุตูุงุญุงุช - DFK Manga Website

## ๐ ููุฎุต ุงููุดุงูู ูุงูุญููู

### ๐ด ุงููุดุงูู ุงูุชู ุชู ุงูุชุดุงููุง:

#### 1. ูุดููุฉ ูู `Navbar.tsx` (ุชู ุงูุฅุตูุงุญ โ)
**ุงููุดููุฉ:**
- ุงูููุฏ ูู ุงูุณุทูุฑ 17-24 ูุงู **ููุณูุฑุงู ุชูุงูุงู**
- ูู ููู ููุงู `useEffect` ูุงูู ูุฌูุจ ุจูุงูุงุช ุงููุณุชุฎุฏู
- ูุงู ุงูููุฏ ูุจุฏุฃ ุจู `if (profile)` ุจุฏูู ุณูุงู

**ุงูุญู:**
```typescript
// โ ุงูููุฏ ุงููุฏูู (ููุณูุฑ):
if (profile) setUserRole((profile as any).role);
} else {
    setUserRole(null);
}
});
return () => subscription.unsubscribe();

// โ ุงูููุฏ ุงูุฌุฏูุฏ (ุตุญูุญ):
useEffect(() => {
    const subscription = supabase.auth.onAuthStateChange(async (event, session) => {
        if (session?.user) {
            setUser(session.user);
            
            const { data: profile } = await supabase
                .from('profiles' as any)
                .select('role')
                .eq('id', session.user.id)
                .single();
            
            if (profile) {
                setUserRole((profile as any).role);
            }
        } else {
            setUser(null);
            setUserRole(null);
        }
    });

    return () => subscription.data.subscription.unsubscribe();
}, []);
```

#### 2. ูุดุงูู ูู Database RLS Policies
**ุงููุดููุฉ:**
- ุงูุตูุงุญูุงุช (RLS Policies) ุบูุฑ ูุถุจูุทุฉ ุจุดูู ุตุญูุญ
- ูุฏ ูุง ูุชููู ุงูู Admins ูู ุฅุถุงูุฉ/ุชุนุฏูู/ุญุฐู ุงูุจูุงูุงุช
- ูุฏ ูุง ุชุธูุฑ ุงูุจูุงูุงุช ูููุณุชุฎุฏููู ุงูุนุงุฏููู

**ุงูุญู:**
ุชู ุฅูุดุงุก ููู `COMPLETE_DATABASE_FIX_V2.sql` ุงูุฐู ูุญุชูู ุนูู:
- โ ุฅุตูุงุญ ุฌุฏูู `profiles` ูุฅุถุงูุฉ trigger ุชููุงุฆู
- โ ุฅุตูุงุญ RLS Policies ูุฌููุน ุงูุฌุฏุงูู
- โ ุฅุถุงูุฉ indexes ูุชุญุณูู ุงูุฃุฏุงุก
- โ ุงูุชุฃูุฏ ูู ูุฌูุฏ ุฏุงูุฉ `increment_views`

#### 3. ูุดุงูู ุนูุฏ ุฑูุน ุนุฏุฉ ูุตูู (Bulk Upload)
**ุงููุดููุฉ:**
- ูุฏ ูุญุฏุซ bug ุนูุฏ ุฑูุน 5 ูุตูู ุฃู ุฃูุซุฑ
- ูุฏ ุชููู ุงููุดููุฉ ูู ุชุฑุชูุจ ุงูุตูุฑ ุฃู ูุนุงูุฌุฉ ุงูู ZIP

**ุงูุญู:**
ุงูููุฏ ูู `admin/page.tsx` ูุณุชุฎุฏู:
- โ Regex ูุญุณูู ูุงุณุชุฎุฑุงุฌ ุฃุฑูุงู ุงููุตูู
- โ ุชุฑุชูุจ ุงูุตูุฑ ุจุดูู ุตุญูุญ
- โ Batch processing (ุฑูุน 5 ุตูุฑ ูู ููุณ ุงูููุช)
- โ Compression ุชููุงุฆู ููุตูุฑ (WebP)

---

## ๐ฏ ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ:

### โ 1. ุฅุตูุงุญ Navbar.tsx
- **ุงูููู:** `app/components/Navbar.tsx`
- **ุงูุชุบููุฑ:** ุฅุนุงุฏุฉ ูุชุงุจุฉ `useEffect` ุจุดูู ูุงูู
- **ุงููุชูุฌุฉ:** ุงูุขู ูุฌูุจ ุฏูุฑ ุงููุณุชุฎุฏู ุจุดูู ุตุญูุญ ููุนุฑุถ ุฒุฑ ููุญุฉ ุงูุชุญูู ููุฃุฏูุงุฑ ุงูููุงุณุจุฉ

### โ 2. ุฅูุดุงุก ููู SQL ุดุงูู
- **ุงูููู:** `COMPLETE_DATABASE_FIX_V2.sql`
- **ุงููุญุชูู:**
  - ุฅุตูุงุญ ุฌุฏูู `profiles`
  - ุฅุถุงูุฉ trigger ุชููุงุฆู ูุฅูุดุงุก profile ุนูุฏ ุงูุชุณุฌูู
  - ุฅุตูุงุญ RLS Policies ูุฌููุน ุงูุฌุฏุงูู
  - ุฅุถุงูุฉ indexes ูุชุญุณูู ุงูุฃุฏุงุก
  - ุชุญุฏูุซ ุฏูุฑ Super Admin

### โ 3. ุฅูุดุงุก ุฏููู ุงูุฅุตูุงุญ
- **ุงูููู:** `FIX_GUIDE.md`
- **ุงููุญุชูู:** ุชุนูููุงุช ุฎุทูุฉ ุจุฎุทูุฉ ูุชุทุจูู ุงูุฅุตูุงุญุงุช

---

## ๐ ุฎุทูุงุช ุงูุชุทุจูู (ูุฌุจ ุชูููุฐูุง):

### โ๏ธ ููู ุฌุฏุงู: ูุฌุจ ุชุทุจูู ููู SQL ูู Supabase

**ูู ูุชู ุชุทุจูู ุฅุตูุงุญุงุช ุงูู Database ุจุนุฏ!** ูุฌุจ ุนููู:

1. **ุงูุชุญ Supabase Dashboard**
   - ุงุฐูุจ ุฅูู: https://supabase.com/dashboard
   - ุงุฎุชุฑ ูุดุฑูุนู

2. **ุงูุชุญ SQL Editor**
   - ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉุ ุงุฎุชุฑ "SQL Editor"
   - ุฃู ุงุฐูุจ ูุจุงุดุฑุฉ ุฅูู: `https://supabase.com/dashboard/project/YOUR_PROJECT_ID/sql`

3. **ููุฐ ููู SQL**
   - ุงูุชุญ ููู `COMPLETE_DATABASE_FIX_V2.sql` ูู ุงููุดุฑูุน
   - ุงูุณุฎ **ูู** ูุญุชูุงู
   - ุงูุตูู ูู SQL Editor
   - ุงุถุบุท **Run** ุฃู **F5**
   - ุงูุชุธุฑ ุญุชู ููุชูู ุงูุชูููุฐ

4. **ุชุญูู ูู ุงููุชุงุฆุฌ**
   - ูุฌุจ ุฃู ุชุฑู ูู ุงููุชุงุฆุฌ ุนุฏุฏ ุงูู profiles, mangas, chapters, ุฅูุฎ
   - ุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก

5. **ุฃุนุฏ ุชุดุบูู ุงูุชุทุจูู**
   ```bash
   # ูู Terminalุ ุงุถุบุท Ctrl+C ุซู:
   npm run dev
   ```

6. **ุณุฌู ุฏุฎูู ุจุญุณุงุจ Admin**
   - ุงุณุชุฎุฏู: `dfk_admin2002@gmail.com`
   - ูุฌุจ ุฃู ูุธูุฑ ุฒุฑ "ููุญุฉ ุงูุชุญูู" ูู ุงูู Navbar

---

## ๐งช ุงูุชุญูู ูู ุงููุชุงุฆุฌ:

### โ ูุง ูุฌุจ ุฃู ูุนูู ุงูุขู:

1. **ุฒุฑ ููุญุฉ ุงูุชุญูู ูุธูุฑ ููู Admins ููุท**
   - ุงููุณุชุฎุฏููู ุงูุนุงุฏููู: โ ูุง ูุฑูู ุงูุฒุฑ
   - Editors: โ ูุฑูู ุงูุฒุฑ
   - Admins: โ ูุฑูู ุงูุฒุฑ
   - Super Admins: โ ูุฑูู ุงูุฒุฑ + ุชุจููุจ "ุงููุฑูู"

2. **ุฌููุน ูุธุงุฆู ููุญุฉ ุงูุชุญูู ุชุนูู**
   - โ ุฅุถุงูุฉ ูุงูุฌุง ุฌุฏูุฏุฉ
   - โ ุฑูุน ูุตู ูุงุญุฏ
   - โ ุฑูุน ุนุฏุฉ ูุตูู (Bulk)
   - โ ุชุนุฏูู ุงููุงูุฌุง
   - โ ุชุนุฏูู ุงููุตูู
   - โ ุญุฐู ุงููุงูุฌุง ูุงููุตูู
   - โ ุฅุฏุงุฑุฉ ุงููุฑูู (Super Admin ููุท)

3. **ุงูุจูุงูุงุช ุชูุญูุธ ูุชูุฌูุจ ุจุดูู ุตุญูุญ**
   - โ ุงููุงูุฌุง ุชุธูุฑ ูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
   - โ ุงููุตูู ุชุธูุฑ ูู ุตูุญุฉ ุงููุงูุฌุง
   - โ ุงูุตูุฑ ุชูุนุฑุถ ุจุดูู ุตุญูุญ
   - โ ุงูุชุนุฏููุงุช ุชูุญูุธ ููุฑุงู

---

## ๐ ุงูุญุงูุฉ ุงูุญุงููุฉ:

### ูุง ุชู ุงูุชุญูู ููู:
- โ ุงูููุฏ ูู `Navbar.tsx` ุชู ุฅุตูุงุญู
- โ ุงููุณุชุฎุฏู ุงูุญุงูู (test1) **ูุง ูุฑู** ุฒุฑ ููุญุฉ ุงูุชุญูู - ููุฐุง **ุตุญูุญ** ูุฃูู ููุณ Admin
- โ ุงููููุน ูุนูู ุจุฏูู ุฃุฎุทุงุก

### ูุง ูุญุชุงุฌ ุฅูู ุชุทุจูู:
- โ๏ธ **ูุฌุจ ุชุทุจูู ููู SQL ูู Supabase** (ูู ูุชู ุจุนุฏ)
- โ๏ธ **ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู ุจุญุณุงุจ Admin** ููุชุญูู ูู ุธููุฑ ุฒุฑ ููุญุฉ ุงูุชุญูู

---

## ๐ ุงูุตูุงุญูุงุช ุงูุฌุฏูุฏุฉ:

| ุงูุฏูุฑ | ุฅุถุงูุฉ ูุงูุฌุง | ุชุนุฏูู ูุงูุฌุง | ุญุฐู ูุงูุฌุง | ุฅุถุงูุฉ ูุตูู | ุชุนุฏูู ูุตูู | ุญุฐู ูุตูู | ุฅุฏุงุฑุฉ ุงููุฑูู |
|-------|------------|------------|-----------|-----------|-----------|----------|-------------|
| **User** | โ | โ | โ | โ | โ | โ | โ |
| **Editor** | โ | โ | โ | โ | โ | โ | โ |
| **Admin** | โ | โ | โ | โ | โ | โ | โ |
| **Super Admin** | โ | โ | โ | โ | โ | โ | โ |

---

## ๐ฌ ุงูุฎุทูุงุช ุงูุชุงููุฉ:

1. **ุทุจู ููู SQL ูู Supabase** (ุงูุฃูู!)
2. **ุฃุนุฏ ุชุดุบูู ุงูุชุทุจูู**
3. **ุณุฌู ุฏุฎูู ุจุญุณุงุจ Admin**
4. **ุชุญูู ูู ุธููุฑ ุฒุฑ ููุญุฉ ุงูุชุญูู**
5. **ุงุฎุชุจุฑ ุฌููุน ุงููุธุงุฆู**
6. **ุฃุจูุบูู ุจุงููุชุงุฆุฌ**

---

## ๐ ุฅุฐุง ุงุญุชุฌุช ูุณุงุนุฏุฉ:

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉ:
1. ุงูุชุญ Console ูู ุงููุชุตูุญ (F12)
2. ุงุจุญุซ ุนู ุฃุฎุทุงุก (ุจุงูููู ุงูุฃุญูุฑ)
3. ุงูุชูุท screenshot ููุฎุทุฃ
4. ุฃุฑุณูู ูู ูุน ูุตู ุงููุดููุฉ

---

**ููุงุญุธุฉ:** ุฌููุน ุงูุฅุตูุงุญุงุช ุฌุงูุฒุฉุ ููุท ุชุญุชุงุฌ ุฅูู ุชุทุจูู ููู SQL ูู Supabase! ๐
